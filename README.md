# Struts2Exploit
基于BurpSuite开发的被动式Struts2框架漏洞扫描与利用插件

# 工具简介
Struts2框架一个明显的指纹就是URL会以.do或.action结束

所以默认该插件会获取所有通过BurpSuite proxy的HTTP请求报文

并检测其URL中是否包含了上述两个指纹，并对其进行漏洞检测

目前支持检测S2-016,S2-019,S2-032,S2-045,S2-046

支持命令执行，webpath获取，文件上传，自定义路径文件上传

# 工具安装
加载插件
![image](https://user-images.githubusercontent.com/59468443/117759576-94e68900-b256-11eb-97a3-fb023c00c199.png)
加载成功
![image](https://user-images.githubusercontent.com/59468443/117759645-b182c100-b256-11eb-8ca5-b2209abda9b1.png)
检测结果和利用界面
![image](https://user-images.githubusercontent.com/59468443/117760520-5baf1880-b258-11eb-9435-59db7fde185d.png)

# 工具使用
工具加载成功后，默认是开启被动式检测的，并且只会对一个URL检测一次，防止多次重复的检测

当然，如果你不想再检测该站了，也可通过右键`Struts2Exploit->Enable Passive Scan`开启和关闭被动式检测

避免了由于该插件发送了过多的检测报文，导致你被网站防护ban ip的情况发生
![image](https://user-images.githubusercontent.com/59468443/117760324-070b9d80-b258-11eb-87c2-77eb8f8ba6ec.png)

## 检测模块
访问漏洞URL后，会被动的检测漏洞，并将结果展示在该模块中，并会展示请求和响应报文

也可通过选中报文，右键`Struts2Exploit->Send to Scanner`进行主动扫描，主动扫描不受URL检测一次的限制
![image](https://user-images.githubusercontent.com/59468443/117762374-9c5c6100-b25b-11eb-9311-eefb318db14a.png)

## 命令执行模块
选中报文后，通过右键`Struts2Exploit->Send to RemoteCmdExcute`发送到命令执行模块中

自动获取URL和Cookies并自动填充到命令执行模块的Target和Cookies输入栏
![image](https://user-images.githubusercontent.com/59468443/117763028-b0549280-b25c-11eb-809f-b35a4214b16d.png)
执行命令
![image](https://user-images.githubusercontent.com/59468443/117763105-d24e1500-b25c-11eb-9dc4-d3ee970ec46e.png)

## 文件上传模块
选中报文后，通过右键`Struts2Exploit->Send to FileUpload`发送到文件上传模块中
![image](https://user-images.githubusercontent.com/59468443/117763673-c9117800-b25d-11eb-9ccb-6f31e64541d9.png)
根路径文件上传
![image](https://user-images.githubusercontent.com/59468443/117764131-90be6980-b25e-11eb-92e3-b5b630c7b6f1.png)
获取web rootpath
![image](https://user-images.githubusercontent.com/59468443/117764346-e72ba800-b25e-11eb-9499-d6827fa658fe.png)
自定义路径文件上传
![image](https://user-images.githubusercontent.com/59468443/117764525-32de5180-b25f-11eb-88dd-2e142289bbf2.png)


